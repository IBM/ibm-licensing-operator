apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: ibm-license-service-scanner
  namespace: openshift-gitops
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  destination:
    server: https://kubernetes.default.svc
  source:
    repoURL: "https://github.com/IBM/ibm-licensing-operator"
    targetRevision: "master"
    path: deploy/argo-cd/components/scanner
    helm:
      valuesObject:
        namespace: &scanner-namespace ibm-licensing-scanner
        licenseServiceNamespace: ibm-licensing
        spec:
          license:
            accept: true
          license-service-upload-secret: ibm-licensing-scanner-upload-secret
          log-level: INFO
          registry-pull-secret: ibm-licensing-scanner-registry-pull-secret
          scan:
            namespaces:
              - *scanner-namespace
